<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UGM (α=[1.0,1.0,1.0,1.0], g=1.00e-01) - 3D Trajectory Viewer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #000;
            color: #fff;
            overflow: hidden;
        }
        
        #canvas-container {
            width: 100vw;
            height: 100vh;
        }
        
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            max-width: 300px;
        }
        
        .info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            max-width: 350px;
        }
        
        h3 {
            margin: 0 0 15px 0;
            font-size: 18px;
        }
        
        .button {
            background: #2980b9;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .button:hover {
            background: #3498db;
        }
        
        .button.active {
            background: #e74c3c;
        }
        
        .slider-container {
            margin: 10px 0;
        }
        
        .slider {
            width: 100%;
            margin: 5px 0;
        }
        
        .particle-toggle {
            margin: 5px 0;
        }
        
        .particle-toggle input {
            margin-right: 5px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border-radius: 3px;
        }
        
        .view-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.6);
            padding: 10px;
            border-radius: 4px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="canvas-container"></div>
    
    <div class="controls">
        <h3>View Controls</h3>
        <button class="button" onclick="setView('third')">Third Person</button>
        <button class="button" onclick="setView('first')">First Person</button>
        <button class="button" onclick="setView('top')">Top View</button>
        <button class="button" onclick="setView('follow')">Follow Particle</button>
        
        <h3 style="margin-top: 20px;">Animation</h3>
        <button class="button" id="playPauseBtn" onclick="toggleAnimation()">Pause</button>
        <button class="button" onclick="resetAnimation()">Reset</button>
        
        <div class="slider-container">
            <label>Speed: <span id="speedValue">1.0</span>x</label>
            <input type="range" class="slider" id="speedSlider" min="0.1" max="5" step="0.1" value="1">
        </div>
        
        <div class="slider-container">
            <label>Time: <span id="timeValue">0</span>%</label>
            <input type="range" class="slider" id="timeSlider" min="0" max="100" step="0.1" value="0">
        </div>
        
        <h3 style="margin-top: 20px;">Particles</h3>
        <div id="particleToggles"></div>
    </div>
    
    <div class="info">
        <h3>UGM (α=[1.0,1.0,1.0,1.0], g=1.00e-01)</h3>
        <p>Black Hole Mass: 99450000000000.0 kg</p>
        <p>Schwarzschild Radius: <span id="schwarzschildRadius"></span> M</p>
        
        <h3 style="margin-top: 15px;">Legend</h3>
        <div id="legend"></div>
        
        <h3 style="margin-top: 15px;">Current State</h3>
        <div id="currentState">
            <p>Particle: <span id="currentParticle">-</span></p>
            <p>Position: r = <span id="currentR">-</span> M</p>
            <p>Time: <span id="currentTime">-</span> s</p>
        </div>
    </div>
    
    <div class="view-info" id="viewInfo">
        Third Person View - Use mouse to orbit
    </div>

    <script>
        // Theory data
        const theoryName = 'UGM (α=[1.0,1.0,1.0,1.0], g=1.00e-01)';
        const blackHoleMass = 99450000000000.0;
        const particleData = {"electron": {"positions": [[7.426160269118666e-12, 0.0], [7.426079817750033e-12, 3.1325263715152365e-05], [7.425838457578053e-12, 6.26518849537532e-05], [7.425436170738219e-12, 9.398122160638302e-05], [7.42487292688827e-12, 0.0001253146322924664], [7.424148683532862e-12, 0.00015665347673951327], [7.423263386343106e-12, 0.0001879991161404227], [7.422216968462588e-12, 0.00021935291352883707], [7.42100935081758e-12, 0.00025071623415009954], [7.419640441748094e-12, 0.00028209044583375027], [7.418110137648077e-12, 0.0003134769193735436], [7.416418322585823e-12, 0.0003448770288923756], [7.414564867920716e-12, 0.00037629215223243745], [7.412549632929907e-12, 0.0004077236713307858], [7.410372464414309e-12, 0.0004391729726035134], [7.408033196980153e-12, 0.00047064144733307086], [7.405531652289435e-12, 0.000502130492053203], [7.402867638988884e-12, 0.0005336415089550442], [7.40004095331817e-12, 0.000565175906279794], [7.39705137868656e-12, 0.000596735098721506], [7.393898685933378e-12, 0.0006283205078344852], [7.390582632541833e-12, 0.0006599335624396615], [7.387102962540954e-12, 0.000691575699053997], [7.383459407447658e-12, 0.0007232483623076636], [7.379651685108882e-12, 0.0007549530053669983], [7.375679499586222e-12, 0.0007866910903817556], [7.371542541737202e-12, 0.0008184640889208757], [7.367240489094418e-12, 0.0008502734824211948], [7.362773005377352e-12, 0.0008821207626372701], [7.358139739635133e-12, 0.0009140074321111664], [7.35334032717678e-12, 0.0009459350046504459], [7.348374389054893e-12, 0.0009779050057958589], [7.343241531546946e-12, 0.0010099189733229917], [7.337941347082505e-12, 0.001041978457734345], [7.332473412970974e-12, 0.0010740850227609737], [7.326837291220246e-12, 0.0011062402458936415], [7.321032529085732e-12, 0.0011384457189053338], [7.315058658506133e-12, 0.0011707030483913375], [7.308915196279932e-12, 0.0012030138563209624], [7.302601643476527e-12, 0.001235379780594686], [7.296117484835714e-12, 0.001267802475627378], [7.289462188528412e-12, 0.0013002836129381396], [7.282635206304078e-12, 0.0013328248817609275], [7.275635973632789e-12, 0.001365427989655853], [7.2684639094611955e-12, 0.0013980946631423831], [7.2611184151530444e-12, 0.0014308266483410961], [7.25359887421271e-12, 0.0014636257116532722], [7.245904652794562e-12, 0.0014964936404361848], [7.238035099420236e-12, 0.0015294322437033419], [7.229989544265e-12, 0.001562443352835815], [7.221767298009922e-12, 0.0015955288223278132], [7.213367652332613e-12, 0.001628690530552797], [7.204789879983743e-12, 0.0016619303805354491], [7.196033234017976e-12, 0.0016952503007531682], [7.187096947426417e-12, 0.0017286522459604788], [7.177980232755699e-12, 0.0017621381980373466], [7.168682281713199e-12, 0.0017957101668624209], [7.159202264757921e-12, 0.0018293701912122798], [7.149539330676479e-12, 0.0018631203396877996], [7.1396926066019346e-12, 0.0018969627116688214], [7.129661196642699e-12, 0.0019308994382896186], [7.119444181877555e-12, 0.001964932683471273], [7.109040620321348e-12, 0.0019990646449511854], [7.098449545009805e-12, 0.0020332975553725863], [7.087669964410242e-12, 0.002067633683409614], [7.0767008623571025e-12, 0.0021020753349106466], [7.065541197012096e-12, 0.002136624854088932], [7.054189900782659e-12, 0.0021712846247531636], [7.042645878704999e-12, 0.002206057071569822], [7.030908008329363e-12, 0.002240944661398956], [7.018975139040319e-12, 0.002275949904635518], [7.006846090869985e-12, 0.0023110753566391957], [6.9945196548311126e-12, 0.0023463236191833157], [6.981994591666456e-12, 0.0023816973419661922], [6.969269631088663e-12, 0.0024171992241771023], [6.9563434715561945e-12, 0.002452832016119456], [6.94321477832433e-12, 0.00248859852088221], [6.92988218259029e-12, 0.002524501596108822], [6.916344281739956e-12, 0.0025605441557972806], [6.902599637862367e-12, 0.0025967291721805605], [6.8886467767929656e-12, 0.002633059677679331], [6.874484187740968e-12, 0.00266953876693045], [6.860110321011512e-12, 0.0027061695988816834], [6.845523586924986e-12, 0.002742955399009596], [6.830722356598158e-12, 0.0027798994615855594], [6.8157049588456685e-12, 0.002817005152032678], [6.800469678960474e-12, 0.0028542759094220787], [6.785014758760844e-12, 0.0028917152490284784], [6.7693383946152576e-12, 0.002929326765006801], [6.753438736066895e-12, 0.0029671141331813248], [6.7373138851330606e-12, 0.003005081113953284], [6.720961893344079e-12, 0.0030432315553165367], [6.704380760176771e-12, 0.003081569396054357], [6.687568432894563e-12, 0.003120098669025255], [6.670522804111634e-12, 0.0031588235046112485], [6.653241710014765e-12, 0.0031977481343201937], [6.6357229285049884e-12, 0.0032368768945507153], [6.617964177254644e-12, 0.0032762142305288494], [6.5999631116751485e-12, 0.003315764700426096], [6.581717323679846e-12, 0.0033555329796692377], [6.563224337682993e-12, 0.0033955238654312875], [6.5444816091929304e-12, 0.003435742281401687], [6.5254865232462974e-12, 0.0034761932826963583], [6.506236389044487e-12, 0.0035168820610747948], [6.486728439127442e-12, 0.0035578139504150058], [6.466959827537044e-12, 0.0035989944324110322], [6.446927625903672e-12, 0.0036404291425810946], [6.426628820338529e-12, 0.0036821238765806915], [6.406060308167722e-12, 0.00372408459683973], [6.385218894498149e-12, 0.0037663174395441844], [6.364101288604567e-12, 0.0038088287219843102], [6.342704100126345e-12, 0.0038516249502931104], [6.321023835061547e-12, 0.003894712827600572], [6.299056891545025e-12, 0.003938099262631172], [6.276799555396153e-12, 0.003981791378774303], [6.254247995420672e-12, 0.004025796523659645], [6.231398258449882e-12, 0.0040701222792720575], [6.208246264099013e-12, 0.004114776472643402], [6.184787799225144e-12, 0.004159767187161791], [6.16101851206334e-12, 0.004205102774542112], [6.1369339060179046e-12, 0.00425079186750542], [6.11252933308361e-12, 0.004296843393218831], [6.087799986869624e-12, 0.004343266587552046], [6.0627408951963766e-12, 0.004390071010211574], [6.037346912232971e-12, 0.004437266560819125], [6.0116127101397876e-12, 0.0044848634960066944], [5.985532770177658e-12, 0.004532872447607448], [5.959101373241354e-12, 0.004581304442028892], [5.932312589771134e-12, 0.004630170920902931], [5.905160268991632e-12, 0.004679483763116442], [5.87763802742235e-12, 0.004729255308336058], [5.8497392365985376e-12, 0.004779498382151979], [5.821457009935017e-12, 0.004830226322978138], [5.792784188658569e-12, 0.004881453010859898], [5.763713326726794e-12, 0.004933192898356054], [5.734236674642581e-12, 0.004985461043679308], [5.7043461620635974e-12, 0.0050382731462989445], [5.674033379095128e-12, 0.005091645585231411], [5.643289556142166e-12, 0.005145595460269258], [5.61210554218257e-12, 0.00520014063642683], [5.580471781307151e-12, 0.005255299791912668], [5.548378287354415e-12, 0.00531109246997436], [5.515814616447063e-12, 0.0053675391350022], [5.482769837213831e-12, 0.005424661233324208], [5.449232498453305e-12, 0.0054824812591777565], [5.415190593965541e-12, 0.005541022826403269], [5.380631524241827e-12, 0.00560031074647445], [5.345542054662104e-12, 0.0056603711135587275], [5.309908269802333e-12, 0.005721231397392864], [5.273715523399451e-12, 0.0057829205448640016], [5.236948383457939e-12, 0.005845469091308442], [5.1995905719080086e-12, 0.005908909282682062], [5.161624898138704e-12, 0.005973275209921288], [5.1230331856276145e-12, 0.0060386029570063185], [5.083796190769141e-12, 0.0061049307644642815], [5.043893512861826e-12, 0.006172299210315838], [5.003303494047448e-12, 0.006240751410782609], [4.9620031077947065e-12, 0.0063103332434447015], [4.919967834281294e-12, 0.006381093595980018], [4.87717152074103e-12, 0.006453084644145651], [4.833586224496206e-12, 0.006526362163295713], [4.789182035975104e-12, 0.006600985878494289], [4.743926878502543e-12, 0.00667701985920775], [4.697786281023674e-12, 0.006754532965687206], [4.650723119147966e-12, 0.006833599355530365], [4.6026973189413885e-12, 0.006914299060608344], [4.553665517006954e-12, 0.0069967186466372054], [4.503580667045056e-12, 0.007080951970311215], [4.45239158578931e-12, 0.0071671010521697255], [4.40004242313546e-12, 0.007255277087500459], [4.346472039919033e-12, 0.007345601622920458], [4.291613277996551e-12, 0.007438207932976618], [4.2353920929004185e-12, 0.00753324263986452], [4.1777265193901595e-12, 0.007630867630853556], [4.1185254280771406e-12, 0.007731262343065661], [4.057687019146426e-12, 0.0078346265054043], [3.995096981917096e-12, 0.007941183454617253], [3.930626226965117e-12, 0.008051184179593916], [3.864128051903786e-12, 0.008164912299747508], [3.795434582864255e-12, 0.00828269025565891], [3.72435222390322e-12, 0.008404887094025246], [3.650655770422506e-12, 0.008531928380838669], [3.5740806705137492e-12, 0.008664309002311953], [3.4943126692369303e-12, 0.008802609957410626], [3.4109736674087527e-12, 0.008947520784790167], [3.323601973545843e-12, 0.009099870135438856], [3.2316238660937477e-12, 0.009260668456544432], [3.1343115929059233e-12, 0.009431169268915749], [3.0307184585583686e-12, 0.009612960117982582], [2.9195741849084426e-12, 0.00980810314004014], [2.79910580558511e-12, 0.010019363485166603], [2.666707209828241e-12, 0.010250605130436555], [2.518264457101613e-12, 0.010507537986533153], [2.3465635081959172e-12, 0.01079930900233102], [2.136564863122258e-12, 0.011142588057752], [1.8435617896622845e-12, 0.01157646459454296], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], "velocities": [], "times": [0.0, 3.128876105920594e-22, 6.257769161080025e-22, 9.386696118749967e-22, 1.2515673940199575e-21, 1.5644719598877948e-21, 1.8773850084321123e-21, 2.190308240628236e-21, 2.503243359880489e-21, 2.816192072431073e-21, 3.129156087777969e-21, 3.4421371190735784e-21, 3.7551368835543766e-21, 4.068157102951828e-21, 4.381199503913446e-21, 4.6942658184271505e-21, 5.00735778424193e-21, 5.320477145314154e-21, 5.633625652236314e-21, 5.946805062677501e-21, 6.260017141828688e-21, 6.573263662845737e-21, 6.886546407320034e-21, 7.199867165732762e-21, 7.513227737915159e-21, 7.826629933537783e-21, 8.140075572584124e-21, 8.453566485838923e-21, 8.7671045153764e-21, 9.080691515071758e-21, 9.394329351121235e-21, 9.708019902547649e-21, 1.0021765061746345e-20, 1.0335566735017361e-20, 1.0649426843107515e-20, 1.0963347321787071e-20, 1.127733012241352e-20, 1.1591377212514917e-20, 1.1905490576385299e-20, 1.2219672215684404e-20, 1.2533924150067133e-20, 1.2848248417818561e-20, 1.3162647076511866e-20, 1.3477122203664229e-20, 1.37916758974168e-20, 1.4106310277222135e-20, 1.4421027484575086e-20, 1.473582968373499e-20, 1.5050719062475123e-20, 1.5365697832842144e-20, 1.5680768231953962e-20, 1.5995932522818882e-20, 1.631119299515782e-20, 1.662655196625854e-20, 1.694201178185362e-20, 1.72575748170231e-20, 1.75732434771229e-20, 1.788902019874013e-20, 1.8204907450676402e-20, 1.8520907734960356e-20, 1.8837023587880008e-20, 1.9153257581078858e-20, 1.9469612322642275e-20, 1.97860904582509e-20, 2.010269467237079e-20, 2.0419427689458848e-20, 2.0736292275218786e-20, 2.1053291237898243e-20, 2.1370427429616768e-20, 2.1687703747775036e-20, 2.200512313646228e-20, 2.2322688587962467e-20, 2.2640403144274322e-20, 2.2958269898697547e-20, 2.3276291997475272e-20, 2.3594472641495294e-20, 2.391281508803886e-20, 2.4231322652636092e-20, 2.454999871094698e-20, 2.486884670072722e-20, 2.5187870123868257e-20, 2.5507072548515262e-20, 2.5826457611250783e-20, 2.614602901941195e-20, 2.6465790553450112e-20, 2.6785746069383724e-20, 2.710589950140176e-20, 2.742625486452058e-20, 2.774681625736766e-20, 2.806758786508072e-20, 2.83885739623286e-20, 2.8709778916440314e-20, 2.9031207190728306e-20, 2.935286334789485e-20, 2.967475205360807e-20, 2.999687808023605e-20, 3.0319246310748036e-20, 3.0641861742791835e-20, 3.0964729492957653e-20, 3.128785480123884e-20, 3.161124303567542e-20, 3.193489969729448e-20, 3.2258830425180845e-20, 3.2583041001873577e-20, 3.290753735902769e-20, 3.3232325583297734e-20, 3.3557411922544324e-20, 3.388280279235451e-20, 3.42085047828956e-20, 3.453452466612379e-20, 3.486086940337033e-20, 3.5187546153329797e-20, 3.551456228047708e-20, 3.584192536394147e-20, 3.616964320686889e-20, 3.6497723846305375e-20, 3.6826175563638067e-20, 3.715500689563255e-20, 3.7484226646108954e-20, 3.781384389830256e-20, 3.814386802795881e-20, 3.847430871721683e-20, 3.8805175969340286e-20, 3.9136480124359893e-20, 3.946823187569739e-20, 3.980044228784756e-20, 4.013312281520165e-20, 4.04662853221038e-20, 4.0799942104240564e-20, 4.113410591147354e-20, 4.14687899722359e-20, 4.180400801962584e-20, 4.2139774319343425e-20, 4.24761036996325e-20, 4.281301158340647e-20, 4.3150514022755565e-20, 4.3488627736055196e-20, 4.382737014791876e-20, 4.416675943226594e-20, 4.4506814558808565e-20, 4.48475553432912e-20, 4.5189002501863535e-20, 4.553117771000755e-20, 4.587410366649407e-20, 4.621780416290322e-20, 4.6562304159311484e-20, 4.6907629866826734e-20, 4.725380883774346e-20, 4.760087006419523e-20, 4.794884408630317e-20, 4.8297763110961134e-20, 4.864766114256336e-20, 4.899857412717404e-20, 4.9350540111866104e-20, 4.9703599421224263e-20, 5.005779485332535e-20, 5.0413171897885943e-20, 5.076977897971747e-20, 5.112766773116776e-20, 5.148689329787732e-20, 5.1847514682962204e-20, 5.2209595135688857e-20, 5.2573202591869554e-20, 5.2938410174636367e-20, 5.3305296766016195e-20, 5.367394766192278e-20, 5.4044455325918495e-20, 5.441692026057622e-20, 5.479145201962667e-20, 5.51681703896658e-20, 5.554720677749078e-20, 5.592870584845912e-20, 5.631282747360378e-20, 5.669974905966363e-20, 5.708966835811296e-20, 5.748280687911182e-20, 5.787941407733289e-20, 5.827977253382189e-20, 5.868420443943364e-20, 5.909307980213901e-20, 5.950682697237189e-20, 5.992594633885988e-20, 6.035102844336285e-20, 6.078277838763787e-20, 6.122204942119271e-20, 6.166989030437846e-20, 6.212761403003734e-20, 6.25969009489852e-20, 6.307995992753464e-20, 6.357979304193727e-20, 6.41006583915022e-20, 6.464894792006637e-20, 6.523504735858592e-20, 6.5877967099342e-20, 6.662036189470008e-20, 6.761522257350061e-20, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "losses": []}, "neutrino": {"positions": [[7.426160269118666e-12, 0.0], [7.423731194381887e-12, 3.762843475869601e-05], [7.421140561716197e-12, 7.52823214268599e-05], [7.418388174805132e-12, 0.00011296332770798879], [7.415473824711416e-12, 0.0001506731287251881], [7.412397289451955e-12, 0.00018841340749841087], [7.409158334593914e-12, 0.00022618585543428168], [7.405756712816987e-12, 0.00026399217280097823], [7.402192163472963e-12, 0.0003018340692373996], [7.398464413168034e-12, 0.0003397132642480673], [7.394573175309234e-12, 0.00037763148771213594], [7.39051814998844e-12, 0.0004155904803999226], [7.386299024212222e-12, 0.00045359199449736525], [7.381915471424151e-12, 0.0004916377941315825], [7.377367151018894e-12, 0.0005297296559196472], [7.372653708195211e-12, 0.0005678693695194117], [7.367774774522678e-12, 0.0006060587381974278], [7.362729967789036e-12, 0.0006442995793848689], [7.357518891126242e-12, 0.0006825937252662457], [7.352141132835735e-12, 0.0007209430233719122], [7.346596266943765e-12, 0.0007593493371898845], [7.340883852651812e-12, 0.0007978145467670342], [7.3350034337847e-12, 0.0008363405493536284], [7.328954539702761e-12, 0.0008749292600382255], [7.322736683983462e-12, 0.000913582612396281], [7.316349364208685e-12, 0.0009523025591769668], [7.309792062492938e-12, 0.0009910910729815957], [7.30306424526537e-12, 0.001029950146965777], [7.296165362263655e-12, 0.0010688817955499242], [7.289094846677627e-12, 0.0011078880551716182], [7.281852115275206e-12, 0.0011469709850230837], [7.274436567362999e-12, 0.0011861326678322473], [7.266847584898374e-12, 0.0012253752106551438], [7.259084531800736e-12, 0.0012647007456887628], [7.251146754055242e-12, 0.0013041114311139776], [7.243033580220969e-12, 0.001343609451943312], [7.2347443198922825e-12, 0.0013831970208914915], [7.22627826336831e-12, 0.0014228763792970421], [7.2176346821337075e-12, 0.0014626497980422223], [7.2088128285208384e-12, 0.0015025195785081313], [7.199811934921804e-12, 0.0015424880535477082], [7.190631212546417e-12, 0.0015825575885060005], [7.1812698518810056e-12, 0.0016227305822706522], [7.171727022716486e-12, 0.001663009468334173], [7.1620018732950384e-12, 0.0017033967158981036], [7.1520935298722845e-12, 0.001743894831010943], [7.142001096263561e-12, 0.001784506357741303], [7.131723653373695e-12, 0.001825233879387821], [7.12126025918006e-12, 0.0018660800197274308], [7.1106099477636745e-12, 0.001907047444292836], [7.099771728314403e-12, 0.0019481388617131781], [7.088744585052961e-12, 0.0019893570250877845], [7.077527476173666e-12, 0.0020307047334055077], [7.0661193342482026e-12, 0.0020721848330232952], [7.054519065622372e-12, 0.0021138002191598173], [7.042725548284045e-12, 0.0021555538374756875], [7.030737632211936e-12, 0.0021974486857088095], [7.0185541392147945e-12, 0.002239487815342426], [7.0061738617223166e-12, 0.002281674333344534], [6.9935955626022585e-12, 0.002324011403969493], [6.9808179733138264e-12, 0.0023665022506114903], [6.967839793683883e-12, 0.0024091501577657476], [6.954659691629643e-12, 0.0024519584730078045], [6.941276301205301e-12, 0.002494930609087809], [6.927688221686405e-12, 0.0025380700460897344], [6.913894017828599e-12, 0.0025813803336874022], [6.8998922183124605e-12, 0.0026248650934425693], [6.885681314789954e-12, 0.002668528021252471], [6.871259760818656e-12, 0.0027123728898315064], [6.856625970190253e-12, 0.00275640355135425], [6.841778317703623e-12, 0.0028006239401559417], [6.826715136088548e-12, 0.0028450380755412137], [6.8114347147937566e-12, 0.002889650064758521], [6.795935300031687e-12, 0.0029344641060453157], [6.780215093517248e-12, 0.0029794844918172316], [6.764272249702974e-12, 0.0030247156119724574], [6.748104874349309e-12, 0.0030701619573929736], [6.731711024441234e-12, 0.0031158281235385706], [6.715088706695012e-12, 0.0031617188142156775], [6.698235874426258e-12, 0.0032078388454900683], [6.6811504258539985e-12, 0.0032541931498355774], [6.663830203853474e-12, 0.0033007867804041016], [6.646272993352885e-12, 0.0033476249155095657], [6.628476519404265e-12, 0.0033947128633160795], [6.610438445165887e-12, 0.0034420560667418245], [6.5921563697912235e-12, 0.0034896601085909525], [6.573627827122458e-12, 0.0035375307169266124], [6.554850281573896e-12, 0.003585673770672571], [6.535821125699787e-12, 0.0036340953055640523], [6.516537679463199e-12, 0.0036828015203060373], [6.4969971876630885e-12, 0.0037317987830608862], [6.477196815152199e-12, 0.003781093638227217], [6.457133643892654e-12, 0.003830692813650316], [6.4368046718682995e-12, 0.003880603228105141], [6.416206808849933e-12, 0.003930831999194], [6.395336872989401e-12, 0.003981386451653452], [6.3741915872366985e-12, 0.004032274126096544], [6.352767575568741e-12, 0.004083502788218499], [6.331061359017582e-12, 0.004135080438496072], [6.309069351484957e-12, 0.00418701532241318], [6.286787855328933e-12, 0.0042393159412479385], [6.264213056707352e-12, 0.004291991063459028], [6.241341020661522e-12, 0.004345049736712364], [6.218167685922221e-12, 0.004398501300592373], [6.1946888594186435e-12, 0.004452355400045812], [6.1709002104692575e-12, 0.004506621999610074], [6.14679726463177e-12, 0.004561311398482287], [6.1223753971874334e-12, 0.004616434246490345], [6.0976298262327686e-12, 0.004672001561032271], [6.07255560534939e-12, 0.004728024745056172], [6.0471476158200004e-12, 0.004784515606159418], [6.021400558355725e-12, 0.004841486376892812], [5.995308944296709e-12, 0.004898949736363291], [5.968867086244405e-12, 0.004956918833237406], [5.942069088079959e-12, 0.0050154073102573965], [5.91490883431877e-12, 0.005074429330392322], [5.8873799787463865e-12, 0.00513399960475857], [5.859475932275468e-12, 0.005194133422457183], [5.831189849957472e-12, 0.0052548466824901665], [5.8025146170759154e-12, 0.005316155927934275], [5.773442834240468e-12, 0.005378078382569123], [5.7439668013925836e-12, 0.005440631990176943], [5.7140785006423455e-12, 0.005503835456754142], [5.6837695777341145e-12, 0.005567708295901458], [5.653031322204331e-12, 0.005632270877687646], [5.621854645910711e-12, 0.0056975444813144125], [5.590230059873988e-12, 0.005763551351948493], [5.558147649244685e-12, 0.005830314762127943], [5.525597046205694e-12, 0.005897859078197659], [5.492567400598429e-12, 0.005966209832283371], [5.4590473480340194e-12, 0.0060353938003751715], [5.425024975220869e-12, 0.006105439087162325], [5.390487782205291e-12, 0.006176375218341955], [5.355422641182031e-12, 0.00624823324121713], [5.319815751485497e-12, 0.006321045834506729], [5.283652590319107e-12, 0.006394847428412873], [5.2469178587183e-12, 0.006469674336134462], [5.209595422170529e-12, 0.006545564898181099], [5.17166824523124e-12, 0.0066225596410345675], [5.133118319375907e-12, 0.006700701451930337], [5.093926583211791e-12, 0.006780035771795523], [5.054072834035651e-12, 0.00686061080869001], [5.0135356295606364e-12, 0.006942477774463581], [4.9722921784416506e-12, 0.007025691147775421], [4.930318217996695e-12, 0.00711030896713783], [4.887587877243443e-12, 0.0071963931582612346], [4.8440735230348034e-12, 0.007284009900715265], [4.799745586670787e-12, 0.0073732300398089996], [4.754572367868946e-12, 0.00746412955066839], [4.708519812369718e-12, 0.007556790062796035], [4.661551258938828e-12, 0.007651299454991811], [4.613627149216468e-12, 0.0077477525324955235], [4.5647046961761064e-12, 0.00784625180062039], [4.514737500899991e-12, 0.007946908352166687], [4.463675109005502e-12, 0.008049842889715565], [4.4114624943536854e-12, 0.00815518690866071], [4.3580394549183545e-12, 0.008263084072910782], [4.303339901833198e-12, 0.008373691822973426], [4.247291017590061e-12, 0.008487183266183003], [4.18981225270552e-12, 0.008603749411944013], [4.1308141212957004e-12, 0.008723601832131729], [4.0701967440222645e-12, 0.008846975849786139], [4.007848070509614e-12, 0.008974134390210388], [3.943641690671878e-12, 0.009105372670840365], [3.877434112533207e-12, 0.009241023964694867], [3.809061338609644e-12, 0.009381466754275375], [3.7383345067074845e-12, 0.009527133709932164], [3.665034262730683e-12, 0.009678523097050378], [3.588903383993376e-12, 0.00983621346919261], [3.5096369396032548e-12, 0.010000882888138326], [3.4268689034084737e-12, 0.010173334509700269], [3.3401535384844597e-12, 0.010354531332544641], [3.248938723196515e-12, 0.01054564450191485], [3.1525267881419356e-12, 0.010748122299653915], [3.0500144164406092e-12, 0.010963791913276693], [2.940196609407207e-12, 0.01119501553915146], [2.8214041188037807e-12, 0.01144494166140251], [2.691207816537219e-12, 0.011717935151111612], [2.545826993673567e-12, 0.012020375653419475], [2.378773277417008e-12, 0.012362317184718568], [2.1770178922156928e-12, 0.01276158503658082], [1.9050546350400772e-12, 0.013257530601938934], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], "velocities": [], "times": [0.0, 3.131182216252226e-22, 6.2626292052599e-22, 9.39435826671517e-22, 1.2526386768170578e-21, 1.5658732149389876e-21, 1.8791411926820126e-21, 2.192444369789823e-21, 2.5057845145703066e-21, 2.8191634043447798e-21, 3.132582825910668e-21, 3.446044576010718e-21, 3.7595504618090895e-21, 4.07310230136717e-21, 4.386701924141997e-21, 4.700351171485227e-21, 5.0140518971581825e-21, 5.3278059678327415e-21, 5.6416152636244195e-21, 5.9554816786274735e-21, 6.2694071214680374e-21, 6.5833935158441874e-21, 6.897442801108722e-21, 7.211556932839688e-21, 7.525737883422775e-21, 7.839987642670727e-21, 8.15430821843154e-21, 8.468701637218494e-21, 8.783169944846048e-21, 9.097715207106041e-21, 9.412339510425496e-21, 9.727044962566257e-21, 1.0041833693333028e-20, 1.0356707855299074e-20, 1.0671669624559336e-20, 1.0986721201484836e-20, 1.1301864811496707e-20, 1.1617102705888699e-20, 1.1932437162643785e-20, 1.2247870487282611e-20, 1.256340501372579e-20, 1.2879043105200011e-20, 1.3194787155170246e-20, 1.3510639588278929e-20, 1.3826602861322785e-20, 1.414267946425871e-20, 1.4458871921239987e-20, 1.4775182791684074e-20, 1.5091614671373436e-20, 1.5408170193579706e-20, 1.5724852030245633e-20, 1.6041662893193723e-20, 1.6358605535374075e-20, 1.667568275216488e-20, 1.6992897382680374e-20, 1.7310252311158644e-20, 1.7627750468396777e-20, 1.79453948332103e-20, 1.8263188433955718e-20, 1.8581134350106408e-20, 1.889923571387092e-20, 1.9217495711909753e-20, 1.953591758705943e-20, 1.9854504640161323e-20, 2.017326023194403e-20, 2.04921877849909e-20, 2.081129078573694e-20, 2.1130572786602658e-20, 2.1450037408148053e-20, 2.1769688341373925e-20, 2.208952935006545e-20, 2.2409564273228246e-20, 2.2729797027673623e-20, 2.3050231610657002e-20, 2.3370872102642045e-20, 2.3691722670160668e-20, 2.4012787568849446e-20, 2.433407114655747e-20, 2.4655577846606393e-20, 2.4977312211170764e-20, 2.529927888486878e-20, 2.5621482618448315e-20, 2.594392827265886e-20, 2.62666208222982e-20, 2.658956536044369e-20, 2.6912767102878716e-20, 2.723623139272553e-20, 2.7559963705270456e-20, 2.788396965309819e-20, 2.8208254991393693e-20, 2.85328256235296e-20, 2.8857687606899425e-20, 2.9182847159131703e-20, 2.9508310664526805e-20, 2.983408468085305e-20, 3.0160175946493874e-20, 3.048659138796859e-20, 3.081333812785113e-20, 3.1140423493112725e-20, 3.146785502391691e-20, 3.179564048289719e-20, 3.212378786495033e-20, 3.24523054075807e-20, 3.278120160183437e-20, 3.3110485203864463e-20, 3.3440165247173154e-20, 3.377025105557932e-20, 3.4100752256965237e-20, 3.443167879786044e-20, 3.4763040958925895e-20, 3.509484937140748e-20, 3.5427115034634105e-20, 3.575984933464263e-20, 3.609306406401973e-20, 3.6426771443059275e-20, 3.676098414234352e-20, 3.7095715306866934e-20, 3.7430978581833584e-20, 3.776678814027207e-20, 3.810315871262707e-20, 3.8440105618503124e-20, 3.8777644800755165e-20, 3.9115792862140904e-20, 3.9454567104775144e-20, 3.979398557265151e-20, 4.013406709752781e-20, 4.0474831348506396e-20, 4.0816298885679433e-20, 4.1158491218253536e-20, 4.150143086761936e-20, 4.1845141435889764e-20, 4.2189647680496856e-20, 4.2534975595515343e-20, 4.288115250046777e-20, 4.3228207137469775e-20, 4.3576169777692204e-20, 4.392507233825481e-20, 4.42749485108274e-20, 4.462583390340278e-20, 4.4977766196926905e-20, 4.533078531873271e-20, 4.568493363503226e-20, 4.6040256165088205e-20, 4.639680082012199e-20, 4.675461867053877e-20, 4.711376424567741e-20, 4.74742958710528e-20, 4.783627604897911e-20, 4.8199771889586826e-20, 4.8564855600625295e-20, 4.893160504614009e-20, 4.9300104386242667e-20, 4.967044481280936e-20, 5.00427253992632e-20, 5.041705408681944e-20, 5.079354883492706e-20, 5.117233897055434e-20, 5.155356677994184e-20, 5.19373893982139e-20, 5.232398106782459e-20, 5.2713535857683103e-20, 5.310627096308033e-20, 5.350243074534943e-20, 5.390229172421428e-20, 5.430616881213203e-20, 5.47144231896825e-20, 5.512747238175891e-20, 5.554580333452496e-20, 5.596998966050725e-20, 5.640071479583048e-20, 5.683880374546486e-20, 5.728526764848908e-20, 5.774136810196293e-20, 5.820871308636179e-20, 5.86894057421585e-20, 5.91862864525902e-20, 5.970335110859921e-20, 6.024653205519104e-20, 6.082531696949156e-20, 6.145664881251142e-20, 6.217686760316549e-20, 6.310101695047285e-20, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "losses": []}, "proton": {"positions": [[7.426160269118666e-12, 0.0], [7.426079846159852e-12, 2.5055785784848075e-05], [7.425838571221612e-12, 5.011265701322415e-05], [7.425436426116138e-12, 7.517169942210261e-05], [7.424873380522549e-12, 0.00010023399933555391], [7.42414939231139e-12, 0.00012530064395880136], [7.423264406855519e-12, 0.00015037272166834527], [7.422218357008729e-12, 0.00017545132231652983], [7.421011164089604e-12, 0.00020053753752350822], [7.41964273683977e-12, 0.00022563246097041448], [7.418112971726353e-12, 0.0002507371887076587], [7.416421752899595e-12, 0.0002758528194466086], [7.414568951809896e-12, 0.00030098045487143333], [7.412554427834047e-12, 0.00032612119993929067], [7.410378027881541e-12, 0.00035127616318738746], [7.408039586675934e-12, 0.00037644645704255756], [7.405538926005867e-12, 0.0004016331981289326], [7.402875854654092e-12, 0.00042683750759252325], [7.400050169005287e-12, 0.00045206051141507365], [7.397061652623037e-12, 0.00047730334073599795], [7.393910076510139e-12, 0.0005025671321779981], [7.390595198323025e-12, 0.0005278530281718636], [7.387116762623181e-12, 0.0005531621772996784], [7.383474501120066e-12, 0.0005784957346234571], [7.379668131865833e-12, 0.0006038548620327668], [7.375697359135009e-12, 0.0006292407285925633], [7.371561874010726e-12, 0.0006546545109011551], [7.36726135425841e-12, 0.0006800973934390909], [7.362795463485349e-12, 0.0007055705689384702], [7.358163851354978e-12, 0.0007310752387535214], [7.353366153078967e-12, 0.0007566126132376198], [7.348401989624689e-12, 0.0007821839121321041], [7.34327096791837e-12, 0.000807790364952159], [7.337972680318729e-12, 0.0008334332113851092], [7.332506704814117e-12, 0.0008591137016964914], [7.326872604101807e-12, 0.000884833097139064], [7.321069925399334e-12, 0.0009105926703859056], [7.315098201367253e-12, 0.0009363937059568652], [7.308956948781103e-12, 0.0009622375006541536], [7.302645668319069e-12, 0.0009881253640236338], [7.296163845097212e-12, 0.0010140586188103048], [7.289510948063745e-12, 0.001040038601429691], [7.282686429761851e-12, 0.0010660666624502876], [7.275689726083457e-12, 0.0010921441670875456], [7.268520256410626e-12, 0.001118272495709894], [7.261177422957188e-12, 0.001144453044351595], [7.253660610096305e-12, 0.0011706872252500446], [7.2459691840621025e-12, 0.0011969764673911024], [7.238102493466996e-12, 0.0012233222170745907], [7.230059868581959e-12, 0.0012497259384769157], [7.221840620613778e-12, 0.0012761891142529368], [7.213444042196795e-12, 0.0013027132461360823], [7.204869407066525e-12, 0.0013292998555612578], [7.1961159688545525e-12, 0.0013559504842990061], [7.187182960720057e-12, 0.0013826666951268492], [7.178069596260292e-12, 0.0014094500725008985], [7.168775068257182e-12, 0.001436302223247069], [7.15929854738148e-12, 0.0014632247772860577], [7.149639182645795e-12, 0.0014902193883803247], [7.1397961014142835e-12, 0.0015172877348903103], [7.129768408504491e-12, 0.0015444315205608507], [7.119555185715863e-12, 0.0015716524753322063], [7.1091554913410045e-12, 0.001598952356176779], [7.098568359659042e-12, 0.0016263329479626462], [7.087792800410352e-12, 0.0016537960643450938], [7.076827798743662e-12, 0.0016813435486873899], [7.065672313668993e-12, 0.0017089772750044038], [7.054325277469857e-12, 0.0017366991489611303], [7.042785596080152e-12, 0.0017645111088816316], [7.0310521484803776e-12, 0.001792415126800446], [7.0191237850087726e-12, 0.0018204132095421583], [7.006999326680353e-12, 0.0018485073998637772], [6.9946775660603615e-12, 0.0018766997776123377], [6.982157264936971e-12, 0.0019049924609236182], [6.96943715355617e-12, 0.0019333876074906684], [6.956515931483494e-12, 0.001961887415851944], [6.943392265115768e-12, 0.001990494126726622], [6.930064786827407e-12, 0.0020192100244278365], [6.916532095809192e-12, 0.002048037438300715], [6.902792755402613e-12, 0.00207697874421473], [6.8888452921411765e-12, 0.0021060363661433955], [6.874688195942071e-12, 0.002135212777774968], [6.860319918480785e-12, 0.00216451050419646], [6.845738872115678e-12, 0.0021939321236443075], [6.830943428768649e-12, 0.0022234802693250357], [6.815931918759787e-12, 0.0022531576313094418], [6.80070262959373e-12, 0.0022829669585040404], [6.78525380538726e-12, 0.0023129110607037263], [6.7695836441703905e-12, 0.0023429928107175494], [6.753690296508355e-12, 0.0023732151466210665], [6.737571865455438e-12, 0.0024035810740667446], [6.7212264043691575e-12, 0.002434093668706091], [6.70465191535133e-12, 0.002464756078716707], [6.687846347620741e-12, 0.0024955715274399244], [6.6708075958137364e-12, 0.0025265433161350487], [6.653533498208927e-12, 0.002557674826856612], [6.636021834871827e-12, 0.002588969525461459], [6.6182703265640956e-12, 0.0026204309647529264], [6.60027663102016e-12, 0.0026520627877535882], [6.58203834081738e-12, 0.002683868731179643], [6.563552982854952e-12, 0.002715852629028961], [6.544818015177349e-12, 0.002748018416356478], [6.525830824535581e-12, 0.002780370133230996], [6.506588723830729e-12, 0.0028129119288841475], [6.487088949432813e-12, 0.002845648066063059], [6.467328659395259e-12, 0.002878582925599045], [6.447304928451061e-12, 0.002911721011184423], [6.427014744901007e-12, 0.0029450669544557316], [6.406455009413771e-12, 0.002978625520273053], [6.385622530570379e-12, 0.0030124016122950866], [6.364514021257957e-12, 0.0030464002788467997], [6.343126094873602e-12, 0.0030806267190985736], [6.321455261326032e-12, 0.00311508628957721], [6.299497922821752e-12, 0.00314978451103073], [6.27725036942139e-12, 0.0031847270756706334], [6.254708774350733e-12, 0.0032199198548171523], [6.231869189049723e-12, 0.0032553689069750977], [6.208727537941321e-12, 0.003291080486370137], [6.18527961290064e-12, 0.0033270610519777997], [6.1615210674030985e-12, 0.0033633172770802062], [6.137447410328547e-12, 0.0033998560593884635], [6.113053999396315e-12, 0.0034366845317719283], [6.088336034203963e-12, 0.003473810073639102], [6.063288548840087e-12, 0.003511240323018856], [6.037906404038881e-12, 0.003548983189395019], [6.012184278841201e-12, 0.0035870468673521476], [5.986116661723643e-12, 0.003625439851095578], [5.959697841164297e-12, 0.0036641709499146543], [5.932921895545195e-12, 0.0037032493046647748], [5.905782682448552e-12, 0.003742684405350767], [5.8782738271836966e-12, 0.0037824861099020803], [5.8503887105374136e-12, 0.003822664664239554], [5.8221204556697335e-12, 0.0038632307237431436], [5.793461914081077e-12, 0.003904195376241165], [5.764405650568926e-12, 0.00394557016665398], [5.734943927083505e-12, 0.003987367123438953], [5.70506868538223e-12, 0.004029598786999056], [5.6747715283716905e-12, 0.004072278240235045], [5.644043700013502e-12, 0.004115419141440806], [5.612876063656421e-12, 0.0041590357597637495], [5.581259078641117e-12, 0.004203143013477277], [5.549182775006081e-12, 0.0042477565113408205], [5.5166367261024875e-12, 0.004292892597355315], [5.483610018902513e-12, 0.00433856839925876], [5.450091221758748e-12, 0.004384801881148466], [5.416068349341688e-12, 0.004431611900664535], [5.381528824446988e-12, 0.00447901827122406], [5.3464594363235326e-12, 0.004527041829858578], [5.310846295126389e-12, 0.004575704511279972], [5.2746747820443554e-12, 0.004625029428883852], [5.237929494588545e-12, 0.004675040963496513], [5.200594186454778e-12, 0.004725764860784313], [5.162651701286427e-12, 0.004777228338375567], [5.124083899563207e-12, 0.004829460203898417], [5.084871577722445e-12, 0.004882490985317944], [5.044994378478716e-12, 0.004936353075167183], [5.004430691140931e-12, 0.004991080890516345], [4.963157540527345e-12, 0.005046711050820227], [4.921150462841424e-12, 0.005103282576135622], [4.8783833665862395e-12, 0.005160837108620629], [4.834828376250848e-12, 0.005219419160731866], [4.790455656084769e-12, 0.005279076394142886], [4.745233210768151e-12, 0.005339859934142567], [4.699126659162103e-12, 0.005401824725167159], [4.652098976556038e-12, 0.005465029934214576], [4.604110199877279e-12, 0.005529539410236523], [4.5551170894481525e-12, 0.005595422209266736], [4.5050727375480284e-12, 0.005662753197136993], [4.453926116735711e-12, 0.00573161374421543], [4.401621552385952e-12, 0.005802092529886543], [4.348098105372276e-12, 0.005874286478697544], [4.293288845003559e-12, 0.005948301855442745], [4.237119987390658e-12, 0.006024255553403105], [4.179509867501985e-12, 0.006102276619023116], [4.120367703927278e-12, 0.006182508068265653], [4.059592102881885e-12, 0.006265109065832536], [3.997069230893635e-12, 0.006350257559956221], [3.93267056189887e-12, 0.006438153494875082], [3.866250071065625e-12, 0.006529022763857927], [3.797640702886219e-12, 0.006623122122914308], [3.7266498568660115e-12, 0.006720745367575946], [3.653053557604343e-12, 0.006822231194698275], [3.5765887919233967e-12, 0.006927973349147808], [3.4969432523150383e-12, 0.007038433926988732], [3.4137413804828717e-12, 0.007154161129928893], [3.326524796255354e-12, 0.007275813451101698], [3.2347243418560537e-12, 0.007404193409949644], [3.1376185412684463e-12, 0.007540295932527201], [3.034269790727383e-12, 0.00768538007174342], [2.9234215133246047e-12, 0.007841079677565158], [2.8033225629107288e-12, 0.008009582890780806], [2.6714042027260744e-12, 0.008193942386948951], [2.52362329025699e-12, 0.00839865895850829], [2.352921555144135e-12, 0.008630918137600575], [2.1446996602762947e-12, 0.008903739685172189], [1.856368505751951e-12, 0.009247258480253652], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]], "velocities": [], "times": [0.0, 3.1283236090645917e-22, 6.256664158390579e-22, 9.385038592268632e-22, 1.2513463863050626e-21, 1.564195693518688e-21, 1.8770534789200463e-21, 2.1899214425884796e-21, 2.502801287030198e-21, 2.8156947175796836e-21, 3.1286034428243196e-21, 3.4415291750026805e-21, 3.754473630433796e-21, 4.067438529927704e-21, 4.380425599206132e-21, 4.6934365693264624e-21, 5.0064731771020334e-21, 5.3195371655480284e-21, 5.6326302843098404e-21, 5.945754290103138e-21, 6.258910947158744e-21, 6.572102027665235e-21, 6.885329312239142e-21, 7.19859459037133e-21, 7.511899660901742e-21, 7.825246332493215e-21, 8.138636424119703e-21, 8.452071765538988e-21, 8.765554197795668e-21, 9.079085573724577e-21, 9.392667758462547e-21, 9.706302629976826e-21, 1.0019992079587104e-20, 1.0333738012504968e-20, 1.0647542348383452e-20, 1.0961407021869098e-20, 1.1275333983189237e-20, 1.1589325198726699e-20, 1.1903382651606377e-20, 1.221750834231915e-20, 1.2531704289334266e-20, 1.2845972529733679e-20, 1.3160315119860761e-20, 1.3474734135983935e-20, 1.3789231674975944e-20, 1.4103809855000542e-20, 1.4418470816233684e-20, 1.4733216721593716e-20, 1.5048049757499126e-20, 1.5362972134618205e-20, 1.5677986088675356e-20, 1.5993093881250717e-20, 1.6308297800610748e-20, 1.6623600162551807e-20, 1.6939003311296437e-20, 1.7254509620385362e-20, 1.757012149359475e-20, 1.78858413659003e-20, 1.8201671704469726e-20, 1.851761500966398e-20, 1.8833673816079032e-20, 1.9149850693619403e-20, 1.9466148248604854e-20, 1.9782569124911634e-20, 2.0099116005149847e-20, 2.0415791611878473e-20, 2.0732598708848047e-20, 2.1049540102319492e-20, 2.1366618642390924e-20, 2.1683837224380954e-20, 2.200119879024633e-20, 2.2318706330086144e-20, 2.263636288365991e-20, 2.2954171541958397e-20, 2.3272135448870328e-20, 2.3590257802868216e-20, 2.390854185875477e-20, 2.4226990929515822e-20, 2.454560838819874e-20, 2.4864397669860566e-20, 2.5183362273635023e-20, 2.550250576483267e-20, 2.582183177713745e-20, 2.614134401488885e-20, 2.646104625545391e-20, 2.678094235169365e-20, 2.7101036234528668e-20, 2.742133191560902e-20, 2.774183349007531e-20, 2.8062545139490083e-20, 2.8383471134835895e-20, 2.870461583965941e-20, 2.9025983713350103e-20, 2.934757931456099e-20, 2.966940730477892e-20, 2.999147245205277e-20, 3.0313779634888344e-20, 3.0636333846319226e-20, 3.095914019813948e-20, 3.128220392540482e-20, 3.1605530391070186e-20, 3.192912509087113e-20, 3.225299365843819e-20, 3.2577141870658224e-20, 3.2901575653297425e-20, 3.322630108690212e-20, 3.355132441296331e-20, 3.3876652040486654e-20, 3.420229055280346e-20, 3.452824671476606e-20, 3.4854527480319895e-20, 3.5181140000476855e-20, 3.5508091631716203e-20, 3.583538994484174e-20, 3.616304273432576e-20, 3.649105802817319e-20, 3.681944409834181e-20, 3.7148209471757396e-20, 3.7477362941966054e-20, 3.780691358146938e-20, 3.8136870754792146e-20, 3.84672441323365e-20, 3.8798043705081333e-20, 3.9129279800190864e-20, 3.946096309760217e-20, 3.9793104647667834e-20, 4.0125715889937013e-20, 4.045880867316587e-20, 4.0792395276657694e-20, 4.112648843304197e-20, 4.146110135261272e-20, 4.179624774935887e-20, 4.213194186883259e-20, 4.24681985180167e-20, 4.280503309736919e-20, 4.314246163524209e-20, 4.3480500824892976e-20, 4.381916806433209e-20, 4.4158481499274727e-20, 4.449846006949999e-20, 4.4839123558951606e-20, 4.5180492649956613e-20, 4.55225889819829e-20, 4.5865435215408466e-20, 4.6209055100834625e-20, 4.6553473554543184e-20, 4.68987167407762e-20, 4.7244812161606973e-20, 4.7591788755275304e-20, 4.79396770039815e-20, 4.828850905227408e-20, 4.863831883733091e-20, 4.8989142232626026e-20, 4.9341017206700366e-20, 4.969398399902179e-20, 5.0048085315235016e-20, 5.040336654447721e-20, 5.0759876001882196e-20, 5.111766519993193e-20, 5.1476789152958226e-20, 5.183730671987699e-20, 5.219928099118351e-20, 5.256277972739266e-20, 5.292787585752681e-20, 5.3294648048005845e-20, 5.366318135447e-20, 5.403356797178176e-20, 5.440590810090245e-20, 5.478031095565728e-20, 5.5156895937954e-20, 5.553579401720975e-20, 5.591714935902588e-20, 5.630112126037676e-20, 5.66878864647874e-20, 5.707764195271312e-20, 5.747060833184017e-20, 5.786703399259863e-20, 5.826720025076686e-20, 5.867142777920527e-20, 5.908008474615263e-20, 5.949359724735408e-20, 5.991246287343794e-20, 6.033726864392747e-20, 6.076871515466113e-20, 6.120764978160158e-20, 6.165511346186696e-20, 6.211240849585316e-20, 6.258120016544276e-20, 6.306367529581839e-20, 6.356280218555144e-20, 6.40827839886729e-20, 6.462991588519247e-20, 6.521439312125746e-20, 6.585478203972812e-20, 6.659234715075466e-20, 6.757103323449213e-20, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "losses": []}};
        
        // Constants
        const G = 6.67430e-11;
        const c = 299792458;
        const M = G * blackHoleMass / (c * c); // Geometric units
        
        // Three.js setup
        let scene, camera, renderer, controls;
        let blackHole, particles = {};
        let trajectoryLines = {};
        let currentPositions = {};
        let animationTime = 0;
        let isPlaying = true;
        let animationSpeed = 1.0;
        let currentView = 'third';
        let activeParticle = 'electron';
        let stars = [];
        let starField;
        
        // Particle colors
        const particleColors = {
            electron: 0x3498db,
            neutrino: 0xe74c3c,
            photon: 0xf39c12,
            proton: 0x2ecc71
        };
        
        function init() {
            // Scene setup
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000814);
            
            // Camera setup
            camera = new THREE.PerspectiveCamera(
                75, 
                window.innerWidth / window.innerHeight,
                0.1,
                50000
            );
            
            // Renderer setup
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.getElementById('canvas-container').appendChild(renderer.domElement);
            
            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 5;
            controls.maxDistance = 500;
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0x404040, 2);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(50, 50, 50);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
            
            // Point light at center for dramatic effect
            const centerLight = new THREE.PointLight(0xff6600, 2, 100);
            centerLight.position.set(0, 0, 0);
            scene.add(centerLight);
            
            // Create background stars
            createStarField();
            
            // Create black hole
            createBlackHole();
            
            // Create reference objects
            createReferenceObjects();
            
            // Load trajectories
            loadTrajectories();
            
            // Set initial camera position
            setView('third');
            
            // Create UI
            createParticleToggles();
            updateLegend();
            
            // Event listeners
            window.addEventListener('resize', onWindowResize);
            document.getElementById('speedSlider').addEventListener('input', updateSpeed);
            document.getElementById('timeSlider').addEventListener('input', updateTimeFromSlider);
            
            // Add debug sphere to ensure something is visible
            const debugGeometry = new THREE.SphereGeometry(1, 16, 16);
            const debugMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
            const debugSphere = new THREE.Mesh(debugGeometry, debugMaterial);
            debugSphere.position.set(15, 0, 0);
            scene.add(debugSphere);
            
            // Start animation
            animate();
        }
        
        function createStarField() {
            // Create star field
            const starsGeometry = new THREE.BufferGeometry();
            const starPositions = [];
            const starColors = [];
            const starSizes = [];
            
            for (let i = 0; i < 5000; i++) {
                // Random position in sphere
                const radius = 200 + Math.random() * 300;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.random() * Math.PI;
                
                const x = radius * Math.sin(phi) * Math.cos(theta);
                const y = radius * Math.sin(phi) * Math.sin(theta);
                const z = radius * Math.cos(phi);
                
                starPositions.push(x, y, z);
                
                // Random star color (white to blue to yellow)
                const colorChoice = Math.random();
                if (colorChoice < 0.3) {
                    starColors.push(1.0, 1.0, 0.8); // Yellowish
                } else if (colorChoice < 0.6) {
                    starColors.push(1.0, 1.0, 1.0); // White
                } else {
                    starColors.push(0.8, 0.8, 1.0); // Bluish
                }
                
                starSizes.push(Math.random() * 2 + 0.5);
                
                // Store star data for animation
                stars.push({
                    theta: theta,
                    phi: phi,
                    radius: radius,
                    speed: 0.00001 + Math.random() * 0.00005
                });
            }
            
            starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starPositions, 3));
            starsGeometry.setAttribute('color', new THREE.Float32BufferAttribute(starColors, 3));
            starsGeometry.setAttribute('size', new THREE.Float32BufferAttribute(starSizes, 1));
            
            const starsMaterial = new THREE.PointsMaterial({
                size: 1.0,
                vertexColors: true,
                transparent: true,
                opacity: 0.8,
                sizeAttenuation: true
            });
            
            starField = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(starField);
        }
        
        function updateStars() {
            if (!starField) return;
            
            const positions = starField.geometry.attributes.position.array;
            
            for (let i = 0; i < stars.length; i++) {
                const star = stars[i];
                star.theta += star.speed;
                
                const idx = i * 3;
                positions[idx] = star.radius * Math.sin(star.phi) * Math.cos(star.theta);
                positions[idx + 1] = star.radius * Math.sin(star.phi) * Math.sin(star.theta);
                positions[idx + 2] = star.radius * Math.cos(star.phi);
            }
            
            starField.geometry.attributes.position.needsUpdate = true;
        }
        
        function createBlackHole() {
            // Event horizon (black sphere)
            const geometry = new THREE.SphereGeometry(2, 64, 64);
            const material = new THREE.MeshPhongMaterial({ 
                color: 0x000000,
                emissive: 0x000000,
                shininess: 0
            });
            blackHole = new THREE.Mesh(geometry, material);
            blackHole.castShadow = true;
            blackHole.receiveShadow = true;
            scene.add(blackHole);
            
            // Inner glow (orange-red)
            const glowGeometry1 = new THREE.SphereGeometry(2.2, 32, 32);
            const glowMaterial1 = new THREE.MeshBasicMaterial({
                color: 0xff4400,
                transparent: true,
                opacity: 0.6,
                side: THREE.BackSide
            });
            const innerGlow = new THREE.Mesh(glowGeometry1, glowMaterial1);
            scene.add(innerGlow);
            
            // Outer glow (red)
            const glowGeometry2 = new THREE.SphereGeometry(2.5, 32, 32);
            const glowMaterial2 = new THREE.MeshBasicMaterial({
                color: 0xff0000,
                transparent: true,
                opacity: 0.3,
                side: THREE.BackSide
            });
            const outerGlow = new THREE.Mesh(glowGeometry2, glowMaterial2);
            scene.add(outerGlow);
            
            // Accretion disk effect
            const diskGeometry = new THREE.TorusGeometry(4, 1, 8, 100);
            const diskMaterial = new THREE.MeshPhongMaterial({
                color: 0xff6600,
                emissive: 0xff3300,
                emissiveIntensity: 0.5,
                transparent: true,
                opacity: 0.7
            });
            const disk = new THREE.Mesh(diskGeometry, diskMaterial);
            disk.rotation.x = Math.PI / 2;
            scene.add(disk);
        }
        
        function createReferenceObjects() {
            // Photon sphere at 3M (bright orange)
            const photonGeometry = new THREE.TorusGeometry(3, 0.1, 16, 100);
            const photonMaterial = new THREE.MeshBasicMaterial({
                color: 0xffa500,
                emissive: 0xffa500,
                emissiveIntensity: 1
            });
            const photonRing = new THREE.Mesh(photonGeometry, photonMaterial);
            photonRing.rotation.x = Math.PI / 2;
            scene.add(photonRing);
            
            // ISCO at 6M (purple)
            const iscoGeometry = new THREE.TorusGeometry(6, 0.15, 16, 100);
            const iscoMaterial = new THREE.MeshBasicMaterial({
                color: 0x9b59b6,
                emissive: 0x9b59b6,
                emissiveIntensity: 0.8
            });
            const iscoRing = new THREE.Mesh(iscoGeometry, iscoMaterial);
            iscoRing.rotation.x = Math.PI / 2;
            scene.add(iscoRing);
            
            // Add labels using sprites
            const labelTexture = createTextTexture('Photon Sphere (3M)', '#ffa500');
            const labelMaterial = new THREE.SpriteMaterial({ map: labelTexture });
            const label = new THREE.Sprite(labelMaterial);
            label.position.set(3, 1, 0);
            label.scale.set(4, 1, 1);
            scene.add(label);
            
            // Grid helper for scale reference
            const gridHelper = new THREE.GridHelper(50, 25, 0x444444, 0x222222);
            gridHelper.position.y = -5;
            scene.add(gridHelper);
        }
        
        function createTextTexture(text, color) {
            const canvas = document.createElement('canvas');
            canvas.width = 256;
            canvas.height = 64;
            const context = canvas.getContext('2d');
            context.font = '24px Arial';
            context.fillStyle = color;
            context.fillText(text, 10, 40);
            const texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;
            return texture;
        }
        
        function loadTrajectories() {
            console.log('Loading trajectories...', particleData);
            
            Object.keys(particleData).forEach(particleName => {
                const data = particleData[particleName];
                if (!data || !data.theory) {
                    console.warn(`No data for particle ${particleName}`);
                    return;
                }
                
                // Create particle mesh (larger and brighter)
                const geometry = new THREE.SphereGeometry(0.8, 32, 32);
                const material = new THREE.MeshPhongMaterial({
                    color: particleColors[particleName],
                    emissive: particleColors[particleName],
                    emissiveIntensity: 0.8,
                    shininess: 100
                });
                const particle = new THREE.Mesh(geometry, material);
                particle.castShadow = true;
                particle.receiveShadow = true;
                particles[particleName] = particle;
                scene.add(particle);
                
                // Add particle glow
                const glowGeometry = new THREE.SphereGeometry(1.2, 16, 16);
                const glowMaterial = new THREE.MeshBasicMaterial({
                    color: particleColors[particleName],
                    transparent: true,
                    opacity: 0.3
                });
                const glow = new THREE.Mesh(glowGeometry, glowMaterial);
                particle.add(glow);
                
                // Create trajectory line
                const points = [];
                const trajectory = data.theory;
                
                // Limit points for performance
                const step = Math.max(1, Math.floor(trajectory.r.length / 1000));
                
                for (let i = 0; i < trajectory.r.length; i += step) {
                    const r = trajectory.r[i];
                    const theta = trajectory.theta[i];
                    const phi = trajectory.phi[i];
                    
                    // Convert spherical to Cartesian
                    const x = r * Math.sin(theta) * Math.cos(phi);
                    const y = r * Math.sin(theta) * Math.sin(phi);
                    const z = r * Math.cos(theta);
                    
                    points.push(new THREE.Vector3(x, z, -y));
                }
                
                const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                const lineMaterial = new THREE.LineBasicMaterial({
                    color: particleColors[particleName],
                    linewidth: 2,
                    transparent: true,
                    opacity: 0.8
                });
                const line = new THREE.Line(lineGeometry, lineMaterial);
                trajectoryLines[particleName] = line;
                scene.add(line);
                
                // Store positions for animation
                currentPositions[particleName] = points;
                
                console.log(`Loaded ${particleName}: ${points.length} points`);
            });
        }
        
        function setView(viewType) {
            currentView = viewType;
            const viewInfo = document.getElementById('viewInfo');
            
            switch(viewType) {
                case 'third':
                    camera.position.set(30, 20, 30);
                    camera.lookAt(0, 0, 0);
                    controls.target.set(0, 0, 0);
                    controls.enabled = true;
                    viewInfo.textContent = 'Third Person View - Use mouse to orbit';
                    break;
                    
                case 'first':
                    controls.enabled = false;
                    viewInfo.textContent = 'First Person View - Following ' + activeParticle;
                    break;
                    
                case 'top':
                    camera.position.set(0, 50, 0);
                    camera.lookAt(0, 0, 0);
                    controls.target.set(0, 0, 0);
                    controls.enabled = true;
                    viewInfo.textContent = 'Top View';
                    break;
                    
                case 'follow':
                    controls.enabled = true;
                    viewInfo.textContent = 'Following ' + activeParticle + ' - Use mouse to orbit';
                    break;
            }
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            // Update stars
            updateStars();
            
            if (isPlaying) {
                animationTime += 0.001 * animationSpeed;
                if (animationTime > 1) animationTime = 0;
                
                // Update time slider
                document.getElementById('timeSlider').value = animationTime * 100;
                document.getElementById('timeValue').textContent = (animationTime * 100).toFixed(1);
            }
            
            // Update particle positions
            Object.keys(particles).forEach(particleName => {
                const particle = particles[particleName];
                const positions = currentPositions[particleName];
                
                if (positions && positions.length > 0) {
                    const index = Math.floor(animationTime * (positions.length - 1));
                    const pos = positions[Math.min(index, positions.length - 1)];
                    
                    if (pos) {
                        particle.position.copy(pos);
                        
                        // Update current state display
                        if (particleName === activeParticle) {
                            const r = Math.sqrt(pos.x * pos.x + pos.y * pos.y + pos.z * pos.z);
                            document.getElementById('currentParticle').textContent = particleName;
                            document.getElementById('currentR').textContent = r.toFixed(2);
                            document.getElementById('currentTime').textContent = (animationTime * 100).toFixed(1);
                        }
                    }
                }
            });
            
            // Handle first person view
            if (currentView === 'first' && particles[activeParticle]) {
                const particle = particles[activeParticle];
                const offset = new THREE.Vector3(0, 2, -5);
                offset.applyQuaternion(particle.quaternion);
                camera.position.copy(particle.position).add(offset);
                camera.lookAt(0, 0, 0);
            } else if (currentView === 'follow' && particles[activeParticle]) {
                const particle = particles[activeParticle];
                controls.target.copy(particle.position);
            }
            
            controls.update();
            renderer.render(scene, camera);
        }
        
        function toggleAnimation() {
            isPlaying = !isPlaying;
            document.getElementById('playPauseBtn').textContent = isPlaying ? 'Pause' : 'Play';
        }
        
        function resetAnimation() {
            animationTime = 0;
            document.getElementById('timeSlider').value = 0;
            document.getElementById('timeValue').textContent = '0';
        }
        
        function updateSpeed() {
            animationSpeed = parseFloat(document.getElementById('speedSlider').value);
            document.getElementById('speedValue').textContent = animationSpeed.toFixed(1);
        }
        
        function updateTimeFromSlider() {
            animationTime = parseFloat(document.getElementById('timeSlider').value) / 100;
            document.getElementById('timeValue').textContent = (animationTime * 100).toFixed(1);
        }
        
        function createParticleToggles() {
            const container = document.getElementById('particleToggles');
            
            Object.keys(particleColors).forEach(particleName => {
                const div = document.createElement('div');
                div.className = 'particle-toggle';
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = particleName + 'Toggle';
                checkbox.checked = true;
                checkbox.onchange = () => toggleParticle(particleName);
                
                const label = document.createElement('label');
                label.htmlFor = checkbox.id;
                label.textContent = particleName.charAt(0).toUpperCase() + particleName.slice(1);
                label.style.marginRight = '10px';
                
                const radio = document.createElement('input');
                radio.type = 'radio';
                radio.name = 'activeParticle';
                radio.value = particleName;
                radio.checked = particleName === 'electron';
                radio.onchange = () => { activeParticle = particleName; };
                
                div.appendChild(checkbox);
                div.appendChild(label);
                div.appendChild(radio);
                container.appendChild(div);
            });
        }
        
        function toggleParticle(particleName) {
            const visible = document.getElementById(particleName + 'Toggle').checked;
            if (particles[particleName]) {
                particles[particleName].visible = visible;
            }
            if (trajectoryLines[particleName]) {
                trajectoryLines[particleName].visible = visible;
            }
        }
        
        function updateLegend() {
            const container = document.getElementById('legend');
            
            Object.keys(particleColors).forEach(particleName => {
                const div = document.createElement('div');
                div.className = 'legend-item';
                
                const color = document.createElement('div');
                color.className = 'legend-color';
                color.style.backgroundColor = '#' + particleColors[particleName].toString(16).padStart(6, '0');
                
                const label = document.createElement('span');
                label.textContent = particleName.charAt(0).toUpperCase() + particleName.slice(1);
                
                div.appendChild(color);
                div.appendChild(label);
                container.appendChild(div);
            });
        }
        
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        // Display Schwarzschild radius
        document.getElementById('schwarzschildRadius').textContent = (2 * M).toFixed(3);
        
        // Initialize
        init();
    </script>
</body>
</html>